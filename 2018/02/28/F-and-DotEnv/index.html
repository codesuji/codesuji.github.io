<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>F# and DotEnv | codesuji</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Often the question arises, what is the best way to manage environment variables for a project.  Many languages have libaries precisely for this issue.  A common approach is the use of a .env file, .NE">
<meta name="keywords" content="F#,FSharp">
<meta property="og:type" content="article">
<meta property="og:title" content="F# and DotEnv">
<meta property="og:url" content="http://codesuji.com/2018/02/28/F-and-DotEnv/index.html">
<meta property="og:site_name" content="codesuji">
<meta property="og:description" content="Often the question arises, what is the best way to manage environment variables for a project.  Many languages have libaries precisely for this issue.  A common approach is the use of a .env file, .NE">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://codesuji.com/images/dotenv1/dotenv_1.png">
<meta property="og:image" content="http://codesuji.com/images/dotenv1/dotenv_2.png">
<meta property="og:updated_time" content="2018-03-01T02:33:22.317Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="F# and DotEnv">
<meta name="twitter:description" content="Often the question arises, what is the best way to manage environment variables for a project.  Many languages have libaries precisely for this issue.  A common approach is the use of a .env file, .NE">
<meta name="twitter:image" content="http://codesuji.com/images/dotenv1/dotenv_1.png">
  
    <link rel="alternate" href="/atom.xml" title="codesuji" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-89982547-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">codesuji</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://codesuji.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-F-and-DotEnv" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/28/F-and-DotEnv/" class="article-date">
  <time datetime="2018-03-01T01:03:12.000Z" itemprop="datePublished">2018-02-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      F# and DotEnv
    </h1>
  

 		<span class="post-count">Read Time: 3 minutes</span>
 	  </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Often the question arises, what is the best way to manage environment variables for a project.  Many languages have libaries precisely for this issue.  A common approach is the use of a <code>.env</code> file, .NET and <a href="http://fsharp.org" target="_blank" rel="noopener">F#</a> are no different.  In today’s post I’ll take a brief look at leveraging DotEnv in an F# application.</p>
<a id="more"></a>
<p>For those not familiar with the concept, an application’s configuration is managed through environment variables.  Although great for deployment, manually setting them locally and/or passing them to other developers can be a pain.  For development, management of environment variables can be easily done using a <code>.env</code> file.  This file resides in the project root.  The DotEnv library loads those environment variables into the executing process.  This allows for the ability to easily share application configuration.  It depends on the library implementation, but often a bonus is that comments are permitted in this file as well.  </p>
<p>There are several packages available that meet this need, I will specifically be looking at <a href="https://www.nuget.org/packages/dotenv.net/" target="_blank" rel="noopener">dotenv.net</a>.</p>
<p>Step one, setup a <code>.env</code> file.  This is simply a list of <code>&lt;key&gt;=&lt;value&gt;</code> pairs.  </p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># My custom environment variables</span><br><span class="line">FOO=myfoo</span><br><span class="line">BAR=mybar</span><br></pre></td></tr></table></figure>
<p>Using <a href="https://github.com/fsprojects/Paket" target="_blank" rel="noopener">Paket</a>, here is the paket.dependencies file.</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source https:<span class="comment">//nuget.org/api/v2</span></span><br><span class="line"></span><br><span class="line">nuget dotenv.net </span><br></pre></td></tr></table></figure>
<p>Below is sample code, along with a sample execution.  Honestly, as an example there isn’t much to look at.  But that is kind of the point.</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#r <span class="string">"./packages/dotenv.net/lib/netstandard2.0/dotenv.net.dll"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> System</span><br><span class="line"><span class="keyword">open</span> dotenv.net</span><br><span class="line"></span><br><span class="line">DotEnv.Config()</span><br><span class="line"></span><br><span class="line">printfn <span class="string">"foo: %A"</span> (Environment.GetEnvironmentVariable(<span class="string">"FOO"</span>))</span><br><span class="line">printfn <span class="string">"bar: %A"</span> (Environment.GetEnvironmentVariable(<span class="string">"BAR"</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/images/dotenv1/dotenv_1.png" alt="Execution Results"></p>
<p>Including packages makes life easy, especially for quick proof-of-concepting.  With that said, the basics of <code>.env</code> are pretty simple to implement.  Below is an F# version.  I’m going to pick on C# a bit too.  I looked at a couple of the implemenations available through nuget.  They share a common theme, they are all drastically longer than the code below.  This is one of the reasons I enjoy F#, it allows me to quickly execute on ideas and not get bogged down in syntax.  As an aside, one notable difference is that my version doesn’t overwrite existing environment variables.  This may be personal preference, but I like the ability to override <code>.env</code> values by explicitly setting environment values.</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> System</span><br><span class="line"><span class="keyword">open</span> System.Text.RegularExpressions</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Load .env file</span></span><br><span class="line"><span class="keyword">let</span> loadDotEnv() = </span><br><span class="line">  <span class="keyword">let</span> envFile = <span class="string">".env"</span></span><br><span class="line">  <span class="keyword">if</span> IO.File.Exists(envFile)</span><br><span class="line">  <span class="keyword">then</span> </span><br><span class="line">    IO.File.ReadAllLines(envFile)</span><br><span class="line">    |&gt; Array.iter (<span class="keyword">fun</span> line -&gt;</span><br><span class="line">      <span class="comment">// Remove comments</span></span><br><span class="line">      <span class="keyword">let</span> line' = Regex.Replace(line, <span class="string">"#.*"</span>, <span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Split into &lt;key&gt;=&lt;value&gt;</span></span><br><span class="line">      <span class="keyword">let</span> parts = line'.Split([|'='|]) |&gt; Array.map (<span class="keyword">fun</span> x -&gt; x.Trim())</span><br><span class="line">      <span class="keyword">if</span> Array.length parts = <span class="number">2</span> </span><br><span class="line">      <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">let</span> (key, value) = (parts.[<span class="number">0</span>], parts.[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Only add key if not already there</span></span><br><span class="line">        <span class="keyword">if</span> String.IsNullOrWhiteSpace(Environment.GetEnvironmentVariable(key))</span><br><span class="line">        <span class="keyword">then</span> Environment.SetEnvironmentVariable(key, value)</span><br><span class="line">        <span class="keyword">else</span> ()</span><br><span class="line">      <span class="keyword">else</span> ())</span><br><span class="line"></span><br><span class="line">loadDotEnv()</span><br><span class="line"></span><br><span class="line">printfn <span class="string">"foo: %A"</span> (Environment.GetEnvironmentVariable(<span class="string">"FOO"</span>))</span><br><span class="line">printfn <span class="string">"bar: %A"</span> (Environment.GetEnvironmentVariable(<span class="string">"BAR"</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/images/dotenv1/dotenv_2.png" alt="Execution Results"></p>
<p>As you can see, the environment variables now populated as desired.  That’s all for today.  Hopefully at least some found this short post useful.  Until next time… </p>

        <div class="related-posts-box">
        Related Posts:<ul class="related-posts"><li class="related-posts-item"><a class="related-posts-link" href="/2018/10/10/F-and-Elasticsearch/">F# and Elasticsearch</a></li><li class="related-posts-item"><a class="related-posts-link" href="/2020/04/25/Web-Scraping-with-F/">Web Scraping with F#</a></li><li class="related-posts-item"><a class="related-posts-link" href="/2017/01/12/Linear-Regression-and-F/">Linear Regression and F#</a></li></ul>        </div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://codesuji.com/2018/02/28/F-and-DotEnv/" data-id="ckgqhw6ue000pl1mwaxyoq9qm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/F/">F#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FSharp/">FSharp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/04/24/FSharp-and-Word-Stems/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          F# and Word Stems
        
      </div>
    </a>
  
  
    <a href="/2018/02/10/Coding-with-Color/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Coding with Color</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/NET-Core/" style="font-size: 17.78px;">.NET Core</a> <a href="/tags/Accord-NET/" style="font-size: 15.56px;">Accord.NET</a> <a href="/tags/Analytics/" style="font-size: 14.44px;">Analytics</a> <a href="/tags/Audio/" style="font-size: 10px;">Audio</a> <a href="/tags/Benchmarking/" style="font-size: 10px;">Benchmarking</a> <a href="/tags/Chiron/" style="font-size: 10px;">Chiron</a> <a href="/tags/Classification/" style="font-size: 11.11px;">Classification</a> <a href="/tags/Cognitive-Services/" style="font-size: 11.11px;">Cognitive Services</a> <a href="/tags/Compiler/" style="font-size: 13.33px;">Compiler</a> <a href="/tags/Computer-Vision/" style="font-size: 11.11px;">Computer Vision</a> <a href="/tags/Cordova/" style="font-size: 10px;">Cordova</a> <a href="/tags/DTW/" style="font-size: 14.44px;">DTW</a> <a href="/tags/Data/" style="font-size: 16.67px;">Data</a> <a href="/tags/Database/" style="font-size: 11.11px;">Database</a> <a href="/tags/Decision-Trees/" style="font-size: 11.11px;">Decision Trees</a> <a href="/tags/Deedle/" style="font-size: 10px;">Deedle</a> <a href="/tags/Delegate/" style="font-size: 10px;">Delegate</a> <a href="/tags/Detection/" style="font-size: 10px;">Detection</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Dynamic-Time-Warping/" style="font-size: 13.33px;">Dynamic Time Warping</a> <a href="/tags/EEG/" style="font-size: 10px;">EEG</a> <a href="/tags/Edges/" style="font-size: 10px;">Edges</a> <a href="/tags/Education/" style="font-size: 10px;">Education</a> <a href="/tags/Elmish/" style="font-size: 10px;">Elmish</a> <a href="/tags/EmguCV/" style="font-size: 10px;">EmguCV</a> <a href="/tags/Entropy/" style="font-size: 10px;">Entropy</a> <a href="/tags/F/" style="font-size: 20px;">F#</a> <a href="/tags/FParsec/" style="font-size: 12.22px;">FParsec</a> <a href="/tags/FSAdvent/" style="font-size: 10px;">FSAdvent</a> <a href="/tags/FSharp/" style="font-size: 20px;">FSharp</a> <a href="/tags/Fable/" style="font-size: 10px;">Fable</a> <a href="/tags/Faces/" style="font-size: 11.11px;">Faces</a> <a href="/tags/Filters/" style="font-size: 10px;">Filters</a> <a href="/tags/Http/" style="font-size: 11.11px;">Http</a> <a href="/tags/Images/" style="font-size: 12.22px;">Images</a> <a href="/tags/Ionide/" style="font-size: 10px;">Ionide</a> <a href="/tags/Kaggle/" style="font-size: 12.22px;">Kaggle</a> <a href="/tags/Keyboard/" style="font-size: 13.33px;">Keyboard</a> <a href="/tags/Legos/" style="font-size: 11.11px;">Legos</a> <a href="/tags/Logging/" style="font-size: 10px;">Logging</a> <a href="/tags/MLNet/" style="font-size: 16.67px;">MLNet</a> <a href="/tags/MSIL/" style="font-size: 12.22px;">MSIL</a> <a href="/tags/Machine-Learning/" style="font-size: 18.89px;">Machine Learning</a> <a href="/tags/MathNet/" style="font-size: 10px;">MathNet</a> <a href="/tags/Messaging/" style="font-size: 10px;">Messaging</a> <a href="/tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="/tags/Mono/" style="font-size: 10px;">Mono</a> <a href="/tags/Morse-Code/" style="font-size: 10px;">Morse Code</a> <a href="/tags/Nix/" style="font-size: 10px;">Nix</a> <a href="/tags/OpenCV/" style="font-size: 10px;">OpenCV</a> <a href="/tags/Optimization/" style="font-size: 10px;">Optimization</a> <a href="/tags/Parsing/" style="font-size: 12.22px;">Parsing</a> <a href="/tags/Performance/" style="font-size: 10px;">Performance</a> <a href="/tags/Presentations/" style="font-size: 10px;">Presentations</a> <a href="/tags/Propagator/" style="font-size: 10px;">Propagator</a> <a href="/tags/Racket/" style="font-size: 10px;">Racket</a> <a href="/tags/Regression/" style="font-size: 10px;">Regression</a> <a href="/tags/Rekognition/" style="font-size: 10px;">Rekognition</a> <a href="/tags/Robotics/" style="font-size: 10px;">Robotics</a> <a href="/tags/Rust/" style="font-size: 10px;">Rust</a> <a href="/tags/STEM/" style="font-size: 11.11px;">STEM</a> <a href="/tags/Scoring/" style="font-size: 10px;">Scoring</a> <a href="/tags/Search/" style="font-size: 10px;">Search</a> <a href="/tags/Serialization/" style="font-size: 10px;">Serialization</a> <a href="/tags/SignalR/" style="font-size: 10px;">SignalR</a> <a href="/tags/Signals/" style="font-size: 12.22px;">Signals</a> <a href="/tags/Similarity/" style="font-size: 11.11px;">Similarity</a> <a href="/tags/Sound/" style="font-size: 10px;">Sound</a> <a href="/tags/Statistics/" style="font-size: 13.33px;">Statistics</a> <a href="/tags/Tail-calls/" style="font-size: 10px;">Tail calls</a> <a href="/tags/Text/" style="font-size: 14.44px;">Text</a> <a href="/tags/Timeseries/" style="font-size: 10px;">Timeseries</a> <a href="/tags/Translation/" style="font-size: 10px;">Translation</a> <a href="/tags/VS-Code/" style="font-size: 10px;">VS Code</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webapi/" style="font-size: 11.11px;">Webapi</a> <a href="/tags/admin/" style="font-size: 11.11px;">admin</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/05/Rust-and-Dynamic-Time-Warping/">Rust and Dynamic Time Warping</a>
          </li>
        
          <li>
            <a href="/2020/10/25/Nix-For-Development/">Nix for Development</a>
          </li>
        
          <li>
            <a href="/2020/10/19/Microbit-Introduction/">Playing with the micro:bit</a>
          </li>
        
          <li>
            <a href="/2020/05/10/Propagator-Networks-in-F/">Propagator Networks in F#</a>
          </li>
        
          <li>
            <a href="/2020/04/25/Web-Scraping-with-F/">Web Scraping with F#</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 codesuji.com<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>